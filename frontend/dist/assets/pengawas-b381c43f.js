import{L as C,P as S}from"./page-header-7252a4a4.js";import{K as k}from"./KecKelurahanList-556de1ec.js";import{_ as I,h as i,j as m,E as h,q as o,m as s,l as t,A as r,x as u,k as b,B,F as K,C as U,y as N}from"./index-234163e1.js";import"./logo-dark-92140013.js";import"./SIIMAH-e113b49b.js";const q={name:"pengawas",components:{Layout:C,PageHeader:S},data(){return{title:"Data Pengawasan",items:[{text:"Menu"},{text:"Pengawasan",active:!0}],selectedBidang:"All",selectedKecamatan:"All",selectedKelurahan:"All",dataList:[],tabIndex:1,currentPage:1,perPage:10,pageOptions:[10,25,50,100],filter:null,sortKey:null,sortAsc:!0,fields:[{key:"nama_cpcl",sortable:!0,label:"Nama CPCL"},{key:"bidang",sortable:!0,label:"Bidang"},{key:"kegiatan",sortable:!0,label:"Kegiatan"},{key:"kecamatan",sortable:!0,label:"Kecamatan"},{key:"kelurahan",sortable:!0,label:"Kelurahan"},{key:"tanggal_selesai_raw",sortable:!0,label:"Tanggal Selesai"},{key:"photo_count",sortable:!0,label:"Jumlah Foto"},{key:"updated_at",sortable:!0,label:"Update Terakhir"},{key:"action",label:"Aksi"}]}},computed:{uniqueKecamatan(){return["All",...Object.keys(k)]},uniqueKelurahan(){return!this.selectedKecamatan||this.selectedKecamatan==="All"?[]:["All",...k[this.selectedKecamatan]||[]]},filteredList(){let n=this.dataList.filter(e=>(!this.selectedBidang||this.selectedBidang==="All"||e.bidang===this.selectedBidang)&&(!this.selectedKecamatan||this.selectedKecamatan==="All"||e.kecamatan===this.selectedKecamatan)&&(!this.selectedKelurahan||this.selectedKelurahan==="All"||e.kelurahan===this.selectedKelurahan)&&(!this.filter||Object.values(e).some(g=>String(g).toLowerCase().includes(this.filter.toLowerCase()))));return this.sortKey&&n.sort((e,g)=>{const _=e[this.sortKey],a=g[this.sortKey];return this.sortAsc?_>a?1:-1:_<a?1:-1}),n},computedFilteredDataList(){return this.filteredList.slice((this.currentPage-1)*this.perPage,this.currentPage*this.perPage)},rows(){return this.filteredList.length}},mounted(){this.fetchData()},watch:{selectedKecamatan(){this.selectedKelurahan="All"}},methods:{scrollPagination(n){this.$el.querySelector(".pagination-scroll").scrollBy({left:n==="left"?-100:100,behavior:"smooth"})},resetFilters(){this.selectedBidang="All",this.selectedKecamatan="All",this.selectedKelurahan="All",this.filter=null,this.currentPage=1},async fetchData(){try{const n=await this.$axios.get("/perumahan/bidangPerumahan");n.data.success&&(this.dataList=n.data.data.map(e=>({...e,tanggal_selesai_raw:e.tanggal_selesai,tanggal_selesai:this.formatDate(e.tanggal_selesai),updated_at:this.formatDateTime(e.updated_at)})))}catch(n){console.error("Fetch error:",n)}},formatDate(n){const e={year:"numeric",month:"long",day:"numeric"};return new Date(n).toLocaleDateString("id-ID",e)},formatDateTime(n){if(!n)return"-";const e=new Date(n);return isNaN(e)?"Invalid Date":e.toLocaleString("id-ID",{year:"numeric",month:"long",day:"numeric"})},goToEdit(n){this.$router.push({name:"editDataPengawas",params:{id:n}})},setSort(n){this.sortKey===n?this.sortAsc=!this.sortAsc:(this.sortKey=n,this.sortAsc=!0)}}},j={class:"row"},E={class:"col-lg-12"},O={class:"card"},z={class:"card-body pt-1"},H={class:"row mt-4 mb-2 align-items-end"},J={class:"col-md-4"},M={class:"col-md-4"},R={class:"col-md-4"},G={class:"mb-3 text-end"},Q={class:"row mt-2 align-items-end"},W={class:"col-sm-12 col-md-6 d-flex align-items-center"},X={class:"d-inline-flex align-items-center mb-0"},Y={class:"ms-3"},Z={class:"col-sm-12 col-md-6 text-md-end"},$={class:"d-inline-flex align-items-center mb-0"},ee={class:"table-responsive mt-3"},te=["onClick"],le=["onClick"],ae={class:"col-12 text-center mt-3"},se={class:"pagination-wrapper d-flex align-items-center justify-content-center"},ne={class:"pagination-scroll overflow-auto"},oe={class:"pagination pagination-rounded mb-0 d-flex justify-content-center"};function re(n,e,g,_,a,d){const v=i("PageHeader"),p=i("BFormSelect"),w=i("BFormInput"),P=i("BTh"),f=i("BTr"),V=i("BThead"),c=i("BTd"),T=i("BTbody"),A=i("BTableSimple"),x=i("BPagination"),L=i("BTab"),D=i("BTabs"),F=i("Layout");return m(),h(F,null,{default:o(()=>[s(v,{title:a.title,items:a.items},null,8,["title","items"]),t("div",j,[t("div",E,[t("div",O,[t("div",z,[s(D,{modelValue:a.tabIndex,"onUpdate:modelValue":e[9]||(e[9]=l=>a.tabIndex=l),"nav-class":"nav-tabs-custom"},{default:o(()=>[s(L,null,{title:o(()=>e[10]||(e[10]=[t("a",{class:"font-weight-bold active"},"Data",-1)])),default:o(()=>[t("div",H,[t("div",J,[e[11]||(e[11]=t("label",null,[t("strong",null,"Filter Bidang:")],-1)),s(p,{modelValue:a.selectedBidang,"onUpdate:modelValue":e[0]||(e[0]=l=>a.selectedBidang=l),options:["All","Perumahan","Permukiman"],class:"form-control"},null,8,["modelValue"])]),t("div",M,[e[12]||(e[12]=t("label",null,[t("strong",null,"Filter Kecamatan:")],-1)),s(p,{modelValue:a.selectedKecamatan,"onUpdate:modelValue":e[1]||(e[1]=l=>a.selectedKecamatan=l),options:d.uniqueKecamatan,class:"form-control"},null,8,["modelValue","options"])]),t("div",R,[e[13]||(e[13]=t("label",null,[t("strong",null,"Filter Kelurahan:")],-1)),s(p,{modelValue:a.selectedKelurahan,"onUpdate:modelValue":e[2]||(e[2]=l=>a.selectedKelurahan=l),options:d.uniqueKelurahan,disabled:!a.selectedKecamatan,class:"form-control"},null,8,["modelValue","options","disabled"])])]),t("div",G,[t("button",{class:"btn btn-sm btn-secondary",onClick:e[3]||(e[3]=(...l)=>d.resetFilters&&d.resetFilters(...l))},e[14]||(e[14]=[t("i",{class:"mdi mdi-refresh me-1"},null,-1),r(" Reset Filter ")]))]),t("div",Q,[t("div",W,[t("label",X,[e[15]||(e[15]=r(" Show  ")),s(p,{modelValue:a.perPage,"onUpdate:modelValue":e[4]||(e[4]=l=>a.perPage=l),size:"sm",options:a.pageOptions},null,8,["modelValue","options"]),e[16]||(e[16]=r(" entries "))]),t("span",Y,[e[17]||(e[17]=r("Total data: ")),t("strong",null,u(d.rows),1)])]),t("div",Z,[t("label",$,[e[18]||(e[18]=r(" Search: ")),s(w,{modelValue:a.filter,"onUpdate:modelValue":e[5]||(e[5]=l=>a.filter=l),type:"search",class:"form-control form-control-sm ms-2"},null,8,["modelValue"])])])]),t("div",ee,[s(A,{class:"table-centered datatable dt-responsive nowrap"},{default:o(()=>[s(V,{class:"table-light"},{default:o(()=>[s(f,null,{default:o(()=>[(m(!0),b(K,null,B(a.fields,l=>(m(),h(P,{key:l.key},{default:o(()=>[r(u(l.label)+" ",1),l.sortable?(m(),b("span",{key:0,onClick:y=>d.setSort(l.key),class:"cursor-pointer ms-1"},[t("i",{class:U(["mdi",a.sortKey===l.key?a.sortAsc?"mdi-arrow-up":"mdi-arrow-down":"mdi-swap-vertical"])},null,2)],8,te)):N("",!0)]),_:2},1024))),128))]),_:1})]),_:1}),s(T,null,{default:o(()=>[(m(!0),b(K,null,B(d.computedFilteredDataList,(l,y)=>(m(),h(f,{key:y},{default:o(()=>[s(c,null,{default:o(()=>[r(u(l.nama_cpcl),1)]),_:2},1024),s(c,null,{default:o(()=>[r(u(l.bidang),1)]),_:2},1024),s(c,null,{default:o(()=>[r(u(l.kegiatan),1)]),_:2},1024),s(c,null,{default:o(()=>[r(u(l.kecamatan),1)]),_:2},1024),s(c,null,{default:o(()=>[r(u(l.kelurahan),1)]),_:2},1024),s(c,null,{default:o(()=>[r(u(l.tanggal_selesai),1)]),_:2},1024),s(c,null,{default:o(()=>[r(u(l.photo_count),1)]),_:2},1024),s(c,null,{default:o(()=>[r(u(l.updated_at),1)]),_:2},1024),s(c,null,{default:o(()=>[t("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:ie=>d.goToEdit(l.id)},e[19]||(e[19]=[t("i",{class:"mdi mdi-camera"},null,-1),r(" Photo ")]),8,le)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),t("div",ae,[t("div",se,[t("button",{class:"scroll-btn me-2",onClick:e[6]||(e[6]=l=>d.scrollPagination("left"))},"‹"),t("div",ne,[t("ul",oe,[s(x,{modelValue:a.currentPage,"onUpdate:modelValue":e[7]||(e[7]=l=>a.currentPage=l),"total-rows":d.rows,"per-page":a.perPage,size:"md"},null,8,["modelValue","total-rows","per-page"])])]),t("button",{class:"scroll-btn ms-2",onClick:e[8]||(e[8]=l=>d.scrollPagination("right"))},"›")])])]),_:1})]),_:1},8,["modelValue"])])])])])]),_:1})}const pe=I(q,[["render",re],["__scopeId","data-v-defe693c"]]);export{pe as default};
